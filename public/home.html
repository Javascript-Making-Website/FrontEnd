<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Emotion Playlist · 감정 테스트</title>
  <link rel="stylesheet" href="./assets/styles.css" />
</head>
<body data-mood="calm">
  <header class="topbar">
    <div class="brand">🧠 감정 테스트</div>
    <nav class="nav">
      <!-- 🔥 감상 버튼 제거 -->
      <a href="./search.html" class="btn">검색</a>
      <a href="./playlist.html" class="btn">내 재생목록</a>
      <a href="./login.html" id="loginLink" class="btn">로그인</a>
      <span id="userBadge" class="badge hidden"></span>
      <button id="logoutBtn" class="btn hidden">로그아웃</button>
    </nav>
  </header>

    <main style="max-width:900px;margin:40px auto 24px;" class= "home-main">
    <!-- 상단 히어로 텍스트 -->
    <h1 class="hero-title">감정으로 음악을 추천받아봐요!</h1>

    <!-- 감정 테스트 패널 -->
    <section id="wizard" class="panel">
      <!-- 진행 점 표시 (1~5: 4단계 + 결과) -->
        <div class="wizard-header">
          <button class="btn ghost hidden" id="backBtn">← 이전으로</button>
          <div class="dots">
            <span class="dot active" data-step-dot="1"></span>
            <span class="dot" data-step-dot="2"></span>
            <span class="dot" data-step-dot="3"></span>
            <span class="dot" data-step-dot="4"></span>
            <span class="dot" data-step-dot="5"></span>
          </div>
        </div>

      <!-- STEP 1: 기본 감정 -->
      <section id="step1" class="step" aria-labelledby="q1">
        <h2 id="q1" class="step-title">지금 어떤 감정이세요?</h2>
        <div class="choices column">
          <button class="choice big" data-emotion="happy">😊 기쁨</button>
          <button class="choice big" data-emotion="sad">😲 슬픔</button>
          <button class="choice big" data-emotion="angry">😡 분노</button>
          <button class="choice big" data-emotion="calm">🌿 차분</button>
          <button class="choice big" data-emotion="passion">🔥 열정</button>
        </div>
      </section>

      <!-- STEP 2: 하위 감정 (동적 생성) -->
      <section id="step2" class="step hidden" aria-labelledby="q2">
        <h2 id="q2">조금 더 구체적으로 말해볼까요?</h2>
        <div id="subEmotionContainer" class="choices column"></div>
        <div class="sub" id="step2Hint"></div>
      </section>

      <!-- STEP 3: 음악 분위기 선택 -->
      <section id="step3" class="step hidden" aria-labelledby="q3">
        <h2 id="q3">지금은 어떤 분위기의 음악이 좋으신가요?</h2>
        <div class="choices grid">
          <button class="choice" data-tone="boost">🎶 기분이 더 좋아지는</button>
          <button class="choice" data-tone="soothe">🌙 마음을 달래주는</button>
          <button class="choice" data-tone="energy">⚡ 힘이 나는</button>
          <button class="choice" data-tone="breeze">☁️ 아무 생각 없이 듣는</button>
          <button class="choice" data-tone="focus">🧘 집중하기 좋은</button>
        </div>
      </section>

      <!-- STEP 4: 장르/국가 선택 -->
      <section id="step4" class="step hidden" aria-labelledby="q4">
        <h2 id="q4">어떤 음악 장르가 가장 끌리나요?</h2>
        <div class="choices grid">
          <button class="choice" data-genre="kpop" data-nation="kr">🇰🇷 K-POP</button>
          <button class="choice" data-genre="jpop" data-nation="jp">🇯🇵 J-POP</button>
          <button class="choice" data-genre="pop" data-nation="global">🌍 POP (글로벌)</button>
          <button class="choice" data-genre="rock" data-nation="global">🎸 락 / 메탈</button>
        </div>
      </section>

      <!-- STEP 5: 결과 -->
      <section id="step5" class="step hidden" aria-labelledby="q5">
        <section id="result" class="step hidden" aria-live="polite" style="margin-top:18px">
          <h2>오늘의 추천 준비 완료 🎧</h2>
          <div class="resultbox" id="resultText" style="margin-bottom:8px"></div>
          <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
            <a class="btn primary" id="goPlayer" href="./player.html">플레이어로 이동</a>
            <button class="btn" id="restart">처음부터 다시</button>
          </div>
        </section>
      </section>
    </section>
    <div id="emotionTrail" class="emotion-trail"></div>
  </main>


  <script src="./assets/api.js"></script>
  <script src="./assets/auth.js"></script>
  <script src="./assets/quiz.js"></script>
  <script>
  document.querySelectorAll('.chip').forEach(chip => {
    chip.addEventListener('click', () => {
      const mood = chip.dataset.mood;
      if (!mood) return;

      // 1) 테마 변경
      document.body.setAttribute('data-mood', mood);

      // 2) active 스타일(선택된 칩 효과)
      document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
      chip.classList.add('active');

      // 필요하면 여기에서 다음 페이지로 이동도 가능
      // location.href = `./search.html?mood=${mood}`;
    });
  });
</script>
</body>
</html>
